import requests

def search_vulnerabilities(service_name, service_version):
    # Example: Search for vulnerabilities using the CVE database
    url = f"https://cve.circl.lu/api/search/{service_name}/{service_version}"
    response = requests.get(url)
    if response.status_code == 200:
        vulnerabilities = response.json()
        return vulnerabilities
    else:
        return None

def detect_vulnerabilities(open_ports):
    vulnerabilities = []
    for port_info in open_ports:
        service_name = port_info[2]
        service_version = port_info[4]  # Assuming service version is available in port_info
        if service_name and service_version:
            vulns = search_vulnerabilities(service_name, service_version)
            if vulns:
                vulnerabilities.extend(vulns)
    return vulnerabilities
